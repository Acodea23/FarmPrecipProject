[
  {
    "objectID": "tutorial.html",
    "href": "tutorial.html",
    "title": "getting started",
    "section": "",
    "text": "Here is how you use my package:"
  },
  {
    "objectID": "usda_scrape.html",
    "href": "usda_scrape.html",
    "title": "Precip Data",
    "section": "",
    "text": "import pandas as pd\nfrom bs4 import BeautifulSoup\nimport numpy as np\nimport requests\nimport re\n\nimport openpyxl\n\n#from dotenv import load_dotenv\nimport os\n\n\nScraping data\n\nurl = \"https://www.ncei.noaa.gov/pub/data/cirs/drd/drd964x.pdsi.txt\"\n\n\n#picking names for files to save. both a txt and a csv\ntxt_name = \"rain.txt\"\ncsv_name = \"rain_dirty.csv\"\n\n# colspecs and cols is formatting specific to this file\n#the first col of the txt contains several pieces of information in a string\ncolspecs = [\n    (0, 2), (2, 4), (4, 6), (6, 10),\n    (10, 17), (17, 24), (24, 31), (31, 38),\n    (38, 45), (45, 52), (52, 59), (59, 66),\n    (66, 73), (73, 80), (80, 87), (87, 94)\n]\n\ncols = [\n    \"state\", \"division\", \"element\", \"year\",\n    \"jan\",\"feb\",\"mar\",\"apr\",\"may\",\"jun\",\"jul\",\"aug\",\n    \"sep\",\"oct\",\"nov\",\"dec\"\n]\n\n\n# takes input that is requests.get()\n# saves txt file from it. no return value\ndef write_txt(r):\n    with open(txt_name, \"wb\") as f:\n        f.write(r.content)\n\n\n# no input, reads txt file, converts strings to numeric values, writes csv with numeric values\ndef txt_to_csv():\n    df = pd.read_fwf(txt_name, colspecs=colspecs, names=cols)\n    df = df.apply(pd.to_numeric, errors='coerce')\n    df.to_csv(csv_name, index=False)\n\n\n# takes a url as an input\n#checks status code = 200 to read it\n#takes data from website and writes to a txt file and a csv\n# MUST BE A TXT FILE URL!!!\ndef read_url_txt(url):\n    # if url[-4] != \".txt\":\n    #     print(\"url must be a txt\")\n    r = requests.get(url)\n    if r.status_code != 200:\n        print(f\"url status code is {r.status_code} not 200. Please check your url\")\n        return\n    write_txt(r)\n    txt_to_csv()\n\nread_url_txt(url)\n\n\n\nCleaning data\nMake a new csv that contains normalized precip data by state\n\ndf = pd.read_csv(\"rain_dirty.csv\")\ndf = df.drop([\"division\", \"element\"], axis = 1)\n\nmonths = [\"jan\",\"feb\",\"mar\",'apr',\"may\",\"jun\",\"jul\",\"aug\",\"sep\",\"oct\",\"nov\",\"dec\"]\n\n# takes are precip data, combines the months, and divisions to get average rain per state per year. After I normalize it\ndef normalized_data(df):\n    #column with yearly average, combines months\n    df[\"yearly_avg\"] = df[months].mean(axis=1)\n    \n    # combines averages across divisions of the state. now average per state\n    #then normalizes values across states and years (x-mean)/std\n    state_precip = df.groupby([\"state\",\"year\"])[\"yearly_avg\"].mean().reset_index(name = \"avg_precip\")\n    state_precip[\"stand_precip\"] = (state_precip[\"avg_precip\"]-state_precip[\"avg_precip\"].mean())/state_precip[\"avg_precip\"].std()\n\n    #writes df to csv\n    state_precip.to_csv(\"rain_clean.csv\")\n\n\n\nFarm data\n\nfarm_data = pd.read_excel(\"VA_State_US.xlsx\")\nfarm_data.head()\n\n\n\n\n\n\n\n\nVA_State_US\nUnnamed: 1\n\n\n\n\n0\nNaN\nUnited States\n\n\n1\nNaN\nAlabama\n\n\n2\nNaN\nAlaska\n\n\n3\nNaN\nArizona\n\n\n4\nNaN\nArkansas\n\n\n\n\n\n\n\n\nexcel_path = \"VA_State_US.xlsx\"\n\n# Read all sheets\nall_sheets = pd.read_excel(excel_path, sheet_name=None)\n\nall_state = pd.DataFrame()\n# `all_sheets` is a dictionary: {sheet_name: DataFrame}\n\n\n\nfor name, df in all_sheets.items():\n    # print(f\"Sheet: {name}\")\n    # print(df.head())\n    if name != \"VA_State_US\":\n        df[\"state\"] = name\n        # removes rows where first column is NaN\n        #df.drop([0,2,3,16,25,34,36,55,57,62,66,72,74,75,76])\n        df = df[df.iloc[:, 1].notna()]\n        df.to_csv(f\"state_farm_data/{name}.csv\")\n\n        all_state = pd.concat([all_state,df])\n\n\nall_state.head()\nall_state.to_csv(\"all_state.csv\")\n\n\n\ncombined_df = pd.concat(all_sheets.values(), ignore_index=True)\nprint(combined_df.head())\ncombined_df.to_csv(\"test.csv\")\n\n   VA_State_US     Unnamed: 1  \\\n0          NaN  United States   \n1          NaN        Alabama   \n2          NaN         Alaska   \n3          NaN        Arizona   \n4          NaN       Arkansas   \n\n  Value added to the U.S. economy by the agricultural sector, 1910-2025F\\nNominal (current dollars)\\n  \\\n0                                                NaN                                                    \n1                                                NaN                                                    \n2                                                NaN                                                    \n3                                                NaN                                                    \n4                                                NaN                                                    \n\n  Unnamed: 2 Unnamed: 3  Unnamed: 4 Unnamed: 5 Unnamed: 6 Unnamed: 7  \\\n0        NaN        NaN         NaN        NaN        NaN        NaN   \n1        NaN        NaN         NaN        NaN        NaN        NaN   \n2        NaN        NaN         NaN        NaN        NaN        NaN   \n3        NaN        NaN         NaN        NaN        NaN        NaN   \n4        NaN        NaN         NaN        NaN        NaN        NaN   \n\n  Unnamed: 8  ... Unnamed: 108 Unnamed: 109 Unnamed: 110 Unnamed: 111  \\\n0        NaN  ...          NaN          NaN          NaN          NaN   \n1        NaN  ...          NaN          NaN          NaN          NaN   \n2        NaN  ...          NaN          NaN          NaN          NaN   \n3        NaN  ...          NaN          NaN          NaN          NaN   \n4        NaN  ...          NaN          NaN          NaN          NaN   \n\n  Unnamed: 112 Unnamed: 113 Unnamed: 114 Unnamed: 115 Unnamed: 116  \\\n0          NaN          NaN          NaN          NaN          NaN   \n1          NaN          NaN          NaN          NaN          NaN   \n2          NaN          NaN          NaN          NaN          NaN   \n3          NaN          NaN          NaN          NaN          NaN   \n4          NaN          NaN          NaN          NaN          NaN   \n\n  Unnamed: 117  \n0          NaN  \n1          NaN  \n2          NaN  \n3          NaN  \n4          NaN  \n\n[5 rows x 119 columns]"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  }
]