{
  "hash": "d73f1bd232eab047a9501adb267df9ea",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Example Usage\"\njupyter: python3\n---\n\nHere is an example of how the functions in our package can work together.\n\n::: {#3e4a5797 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport requests\n```\n:::\n\n\n# PDSI Data\n\nWe start by using our functions to scrape the data, and save it to a csv.\n\n::: {#48830319 .cell execution_count=2}\n``` {.python .cell-code}\n# remember txt_to_csv is called in read_url_txt\nfrom farm_precip_project import read_url_txt\n\nurl = \"https://www.ncei.noaa.gov/pub/data/cirs/drd/drd964x.pdsi.txt\"\n\n\n#picking names for files to save. both a txt and a csv\ntxt_name = \"rain.txt\"\ncsv_name = \"rain_dirty.csv\"\n\n# colspecs and cols is formatting specific to this file\n#the first col of the txt contains several pieces of information in a string\ncolspecs = [\n    (0, 2), (2, 4), (4, 6), (6, 10),\n    (10, 17), (17, 24), (24, 31), (31, 38),\n    (38, 45), (45, 52), (52, 59), (59, 66),\n    (66, 73), (73, 80), (80, 87), (87, 94)\n]\n\ncols = [\n    \"state\", \"division\", \"element\", \"year\",\n    \"jan\",\"feb\",\"mar\",\"apr\",\"may\",\"jun\",\"jul\",\"aug\",\n    \"sep\",\"oct\",\"nov\",\"dec\"\n]\n\nread_url_txt(url, txt_name, csv_name, colspecs, cols)\n\n# The head of the data saved as a .csv\nprint(pd.read_csv(csv_name).head(1).to_markdown())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n|    |   state |   division |   element |   year |   jan |   feb |   mar |   apr |   may |   jun |   jul |   aug |   sep |   oct |   nov |   dec |\n|---:|--------:|-----------:|----------:|-------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|\n|  0 |       1 |          1 |         5 |   1895 |  0.11 | -0.81 | -0.56 | -0.72 | -0.85 | -0.99 |  -0.9 | -1.13 | -1.69 | -1.72 | -2.04 | -2.12 |\n```\n:::\n:::\n\n\nWe then calculate yearly averages for each state and save it in a new csv file. In this case we will read the csv created using *read_url_txt* and perform the calculations on it.\n\n::: {#685b526a .cell execution_count=3}\n``` {.python .cell-code}\nfrom farm_precip_project import normalized_data\n\nmonths = [\"jan\",\"feb\",\"mar\",'apr',\"may\",\"jun\",\"jul\",\"aug\",\"sep\",\"oct\",\"nov\",\"dec\"]\ngroups = [\"state\",\"year\"]\nnew_col_name = \"yearly_avg\"\ncsv_name_clean = \"rain_clean.csv\"\ndf_to_read = \"rain_dirty.csv\"\n\nnormalized_data(df_to_read, new_col_name, csv_name_clean, months, groups)\n\nprint(pd.read_csv(csv_name).head(1).to_markdown())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n|    |   state |   division |   element |   year |   jan |   feb |   mar |   apr |   may |   jun |   jul |   aug |   sep |   oct |   nov |   dec |\n|---:|--------:|-----------:|----------:|-------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|------:|\n|  0 |       1 |          1 |         5 |   1895 |  0.11 | -0.81 | -0.56 | -0.72 | -0.85 | -0.99 |  -0.9 | -1.13 | -1.69 | -1.72 | -2.04 | -2.12 |\n```\n:::\n:::\n\n\n# Farm Income Data\n\n\n# Merging the Data\n\nWe then use *merge_csvs* to combine our farm and PDSI datasets into one csv.\n\n::: {#2bec7631 .cell execution_count=4}\n``` {.python .cell-code}\nfrom farm_precip_project import merge_csvs\nimport pandas as pd\n\ncsvs = [\"FarmIncome_full.csv\", \"rain_clean.csv\"]\ngroup_on = [\"state\", \"year\"]\nnew_csv_name = \"combined_farm_precip.csv\"\n\nmerge_csvs(new_csv_name, csvs, group_on)\n\nprint(pd.read_csv(new_csv_name).head(1).to_markdown())\n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n|    |   state |   year |   Value of crop production |   Crop cash receipts |   Cotton |   Feed crops |   Food grains |   Fruits and nuts |   Oil crops |   Vegetables and melons |   All other crops |   Home consumption |   Inventory adjustment |   yearly_avg |\n|---:|--------:|-------:|---------------------------:|---------------------:|---------:|-------------:|--------------:|------------------:|------------:|------------------------:|------------------:|-------------------:|-----------------------:|-------------:|\n|  0 |       1 |   1949 |                     250813 |               230275 |   150706 |        13405 |           231 |              4937 |       30196 |                   14421 |             16238 |              39680 |                 -19142 |      1.18625 |\n```\n:::\n:::\n\n\n",
    "supporting": [
      "tutorial_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}